<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8" />
<title>Debug Comparar Transformadores</title>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>

<input type="file" id="csvFile" accept=".csv" /><br><br>
ID 1: <input type="text" id="id1Input" disabled><br><br>
ID 2: <input type="text" id="id2Input" disabled><br><br>
<button id="btnComparar" disabled>Comparar</button>

<div id="resultado"></div>

<script>
  let dadosCSV = [];

  document.getElementById('csvFile').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(event) {
      Papa.parse(event.target.result, {
        header: true,
        skipEmptyLines: true,
        complete: function(res) {
          dadosCSV = res.data;
          console.log("Dados CSV:", dadosCSV);
          document.getElementById('id1Input').disabled = false;
          document.getElementById('id2Input').disabled = false;
          document.getElementById('btnComparar').disabled = false;
          document.getElementById('resultado').innerHTML = 'CSV carregado, insere IDs para comparar.';
        }
      });
    };
    reader.readAsText(file);
  });

  document.getElementById('btnComparar').addEventListener('click', function() {
    const id1 = document.getElementById('id1Input').value.trim();
    const id2 = document.getElementById('id2Input').value.trim();
    const resultadoDiv = document.getElementById('resultado');

    if (!id1 || !id2) {
      resultadoDiv.textContent = 'Por favor, insere os dois IDs.';
      return;
    }

    console.log('Procurando ID 1:', id1);
    console.log('Procurando ID 2:', id2);

    const d1 = dadosCSV.find(item => {
      const id = (item.id_secagenscore || '').trim();
      console.log('Comparar ID1:', id);
      return id === id1;
    });

    const d2 = dadosCSV.find(item => {
      const id = (item.id_secagenscore || '').trim();
      console.log('Comparar ID2:', id);
      return id === id2;
    });

    if (!d1 || !d2) {
      resultadoDiv.textContent = 'Não encontrei um ou ambos os IDs no ficheiro.';
      return;
    }

    resultadoDiv.innerHTML = `
      <h3>Comparação</h3>
      <p><strong>ID 1 (${id1}):</strong> Potência=${d1.potencia}, Tensão=${d1.tensao}, Massat=${d1.massat}, Massai=${d1.massai}</p>
      <p><strong>ID 2 (${id2}):</strong> Potência=${d2.potencia}, Tensão=${d2.tensao}, Massat=${d2.massat}, Massai=${d2.massai}</p>
    `;
  });
</script>

</body>
</html>
